function _getExitParams(e,t){var i=t[0].split(","),o=i[0],a=i[1],n=i[2],r=(i[3]||"exit").toLowerCase(),u="sprite"===r,l=bitsy.names.room.get(o);return o&&void 0!==a&&void 0!==n?void 0===l?(console.warn("Bad {"+e+"} parameter: Room '"+o+"' not found!"),null):{room:l,x:Number(a),y:u?15-Number(n):Number(n)}:(console.warn("{"+e+"} was missing parameters! Usage: {"+e+' "roomname,x,y"}'),null)}function doPlayerExit(e){bitsy.player().room=e.room,bitsy.player().x=e.x,bitsy.player().y=e.y,bitsy.curRoom=e.room}var queuedDialogExit=null;before("load_game",function(e,t){return[e.replace(/(^|[^\\])\((exit(Now)? ".+?")\)/g,"$1{$2}").replace(/\\\((exit(Now)? ".+")\\?\)/g,"($1)"),t]}),after("clearGameData",function(){queuedDialogExit=null}),after("onExitDialog",function(){queuedDialogExit&&(doPlayerExit(queuedDialogExit),queuedDialogExit=null)}),bitsy.exitFunc=function(e,t,i){queuedDialogExit=_getExitParams("exit",t),i(null)},bitsy.exitNowFunc=function(e,t,i){var o=_getExitParams("exitNow",t);o&&(doPlayerExit(o),i(null))},inject("var functionMap = new Map();",'functionMap.set("exit", exitFunc);','functionMap.set("exitNow", exitNowFunc);');